<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh-CN" xml:lang="zh-CN">
<head>
<title></title>
<style>
html {overflow:hidden}
body {position: absolute; margin:0; padding:0;width:100%; height:100%; background: #000}
canvas {display:block}
p {text-align: center; font-size:12px;color:#454545;}
</style>
<script src="lib/jcanvas.0.4.js"></script>
<script src="imagedata.js"></script>
<script src="stage.js"></script>
<script src="fsm.js"></script>
<script src="looper.js"></script>
</head>
<body>
<img id="qq" src="imgs/at.png" style="display:none">
<canvas id="canvas" width="800" height="600">your brower can't use canvas.</canvas>
<script>
if(!this.UL){
	this.UL = {};
}

UL.initLogos = function(logoIds){
	UL.imgs = {};
	if(!logoIds || !logoIds.length) return;
	for(var i = 0; i < logoIds.length; i++){
		UL.imgs[logoIds[i]] = new ImgData(document.getElementById('canvas'), document.getElementById(logoIds[i]));
	}
}

UL.init = function(){
	UL.initLogos(['qq'], function(){console.debug('init success');});
}

var atImg = document.getElementById('qq');
atImg.onload = function(){
	atImg.onload = null;
	var atImgData = new ImgData(document.getElementById('canvas'), atImg);
	atImgData.switchRotate();
	document.getElementById('canvas').addEventListener('mousemove', function(e){
		atImgData.angleSpeed_y = (e.x - this.width / 2) / 250 * 0.1;
		atImgData.angleSpeed_x = (e.y - this.height / 2) / 250 * 0.1;
	}, false);
	var timer = window.setInterval(function(){
		if(window.ImgData.debug){
			window.atImgData = atImgData;
			clearInterval(timer);
		}
		atImgData.step_z += 0.01 * atImgData.speed_dir;
		if(Math.abs(atImgData.step_z) > 2) atImgData.speed_dir *= -1; 
		//console.debug(atImgData.step_z);
		atImgData.update();
		atImgData.draw();
	}, 16);
	
}
</script>
</body>
</html>

